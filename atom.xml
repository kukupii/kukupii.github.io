<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Loplooop</title>
  
  <subtitle>Nowhere, everywhere.</subtitle>
  <link href="https://kukupii.github.io/atom.xml" rel="self"/>
  
  <link href="https://kukupii.github.io/"/>
  <updated>2023-03-03T06:12:08.606Z</updated>
  <id>https://kukupii.github.io/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>响应式布局</title>
    <link href="https://kukupii.github.io/2023/03/03/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80-1/"/>
    <id>https://kukupii.github.io/2023/03/03/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80-1/</id>
    <published>2023-03-03T06:10:33.000Z</published>
    <updated>2023-03-03T06:12:08.606Z</updated>
    
    <content type="html"><![CDATA[<p>响应式布局</p><h3 id="媒体查询-mediaQuery"><a href="#媒体查询-mediaQuery" class="headerlink" title="媒体查询 mediaQuery"></a>媒体查询 mediaQuery</h3><h4 id="什么是媒体查询"><a href="#什么是媒体查询" class="headerlink" title="什么是媒体查询"></a>什么是媒体查询</h4><p>概念：为不同尺寸的屏幕设定不同的CSS样式</p><p>简单案例：</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#div0</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 在屏幕宽度为<span class="number">200px</span>到<span class="number">300px</span>之间时，<span class="selector-id">#div0</span>的背景颜色为红色</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-device-iwdth</span>:<span class="number">200px</span>) <span class="keyword">and</span> (<span class="attribute">max-device-iwdth</span>:<span class="number">300px</span>)&#123;</span><br><span class="line">    <span class="selector-id">#div0</span>&#123;</span><br><span class="line">        <span class="attribute">background-color</span>:red;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 在屏幕宽度为<span class="number">301px</span>到<span class="number">500px</span>之间时，<span class="selector-id">#div0</span>的背景颜色为绿色</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-device-iwdth</span>:<span class="number">301px</span>) <span class="keyword">and</span> (<span class="attribute">max-device-iwdth</span>:<span class="number">500px</span>)&#123;</span><br><span class="line">    <span class="selector-id">#div0</span>&#123;</span><br><span class="line">        <span class="attribute">background-color</span>:green;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="media常用参数"><a href="#media常用参数" class="headerlink" title="@media常用参数"></a>@media常用参数</h4><p>width, height &#x3D;&gt; 浏览器可视宽度，高度</p><p>device-width, device-height &#x3D;&gt; 设备屏幕的宽度，高度</p><h4 id="媒体查询引入方式"><a href="#媒体查询引入方式" class="headerlink" title="媒体查询引入方式"></a>媒体查询引入方式</h4><ol><li><p>写在<code>style</code>标签中，有条件的执行某个内部样式表。</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">media</span>=<span class="string">&quot;(min-device-width:100px) and (max-device-iwdth:300px)&quot;</span>&gt;</span></span><br><span class="line">  #div0&#123;</span><br><span class="line">      ...</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><code>link</code>引入，写在link标签中，有条件的引入外部样式表。</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;css/test.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;css/css-1.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">media</span>=<span class="string">&quot;(min-device-width:100px) and (max-device-iwdth:300px)&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="flex弹性布局"><a href="#flex弹性布局" class="headerlink" title="flex弹性布局"></a>flex弹性布局</h3><h4 id="for-parent-element"><a href="#for-parent-element" class="headerlink" title="for parent element"></a>for parent element</h4><h5 id="主轴方向与换行"><a href="#主轴方向与换行" class="headerlink" title="主轴方向与换行"></a>主轴方向与换行</h5><p><strong>flex-direction</strong>：子元素在父元素盒子中的排列方式</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>row</td><td>默认值。灵活的项目将水平显示，正如一个行一样。</td></tr><tr><td>row-reverse</td><td>与 row 相同，但是以相反的顺序。</td></tr><tr><td>column</td><td>灵活的项目将垂直显示，正如一个列一样。</td></tr><tr><td>column-reverse</td><td>与 column 相同，但是以相反的顺序。</td></tr><tr><td>initial</td><td>设置该属性为它的默认值。请参阅 <a href="http://edu.jb51.net/cssref/cssref-initial.html"><em>initial</em></a>。</td></tr><tr><td>inherit</td><td>从父元素继承该属性。请参阅 <a href="http://edu.jb51.net/cssref/cssref-inherit.html"><em>inherit</em></a>。</td></tr></tbody></table><p><strong>flex-wrap</strong>：子元素在父元素盒子里是否换行（列）</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>nowrap</td><td>默认值。不换行或不换列。</td></tr><tr><td>wrap</td><td>换行或换列。</td></tr><tr><td>wrap-reverse</td><td>换行或换列，但以相反的顺序。</td></tr></tbody></table><p><strong>flex-flow</strong>：flex-direction和flex-wrap属性的简写形式。eg: flex-flow: row wrap;</p><h5 id="剩余空间调整为间距"><a href="#剩余空间调整为间距" class="headerlink" title="剩余空间调整为间距"></a>剩余空间调整为间距</h5><p><strong>justify-content</strong>：用来在存在剩余空间时，设置为间距的方式。</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>flex-start</td><td>默认值。从左到右，挨着行的开头。</td></tr><tr><td>flex-end</td><td>从右到左，挨着行的结尾。</td></tr><tr><td>center</td><td>居中显示。</td></tr><tr><td>space-between</td><td>平均分布在该行上，两边不留间隔空间。</td></tr><tr><td>space-around</td><td>平均分布在该行上，两边留一半的间隔空间。</td></tr></tbody></table><p><strong>align-items</strong>：设置每个flex元素在交叉轴上的默认对齐方式（单行，多行中单独处理每一行）</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>flex-start</td><td>位于容器的开头。</td></tr><tr><td>flex-end</td><td>位于容器的结尾。</td></tr><tr><td>center</td><td>居中显示。</td></tr></tbody></table><p><strong>align-content</strong>：设置每个flex元素在交叉轴上的默认对齐方式（把多行当作一个整体处理）</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>flex-start</td><td>位于容器的开头。</td></tr><tr><td>flex-end</td><td>位于容器的结尾。</td></tr><tr><td>center</td><td>居中显示。</td></tr><tr><td>space-between</td><td>之间留有空白。</td></tr><tr><td>space-around</td><td>两端留有空白。</td></tr></tbody></table><h4 id="for-children-elements"><a href="#for-children-elements" class="headerlink" title="for children elements"></a>for children elements</h4><table><thead><tr><th>属性值</th><th>描述</th></tr></thead><tbody><tr><td>flex-basis</td><td>设置弹性盒伸缩基准值。（相当于宽度，设置基准值后，宽度不再生效）</td></tr><tr><td>flex-grow</td><td>设置弹性盒子的扩展比率。</td></tr><tr><td>flex-shrink</td><td>设置弹性盒子的缩小比率。</td></tr><tr><td>flex</td><td>上面三者的缩写。</td></tr></tbody></table><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>flex:auto;</td><td>flex:1 1 auto;</td></tr><tr><td>flex:none;</td><td>flex:0 0 auto;</td></tr><tr><td>flex:0%;</td><td>flex:1 1 0%;</td></tr><tr><td>flex:100px;</td><td>flex:1 1 100px;</td></tr><tr><td>flex:1;</td><td>flex:1 1 0%;</td></tr></tbody></table><h3 id="rem"><a href="#rem" class="headerlink" title="rem"></a>rem</h3><p>概念：指相对于根元素的字体大小的单位</p><p>使用媒体查询+rem或js，在不同宽度的视口下自动调整字体大小。</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">changeRootFontSize</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获取设备的宽度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> deviceWidth = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//假定以20px的字体为默认大小，当前的宽度除以默认宽度。一般字体最大为40px，超过时直接取40；</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> fontSize =</span></span><br><span class="line"><span class="language-javascript">          <span class="number">20</span> * (deviceWidth / <span class="number">320</span>) &gt; <span class="number">40</span> ? <span class="number">40</span> : <span class="number">20</span> * (deviceWidth / <span class="number">360</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">fontSize</span> = fontSize +         <span class="string">&quot;px&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;load&quot;</span>, changeRootFontSize);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>, changeRootFontSize);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="自适应布局"><a href="#自适应布局" class="headerlink" title="自适应布局"></a>自适应布局</h3><p>布局特点：</p><ol><li><p>不同设备对应不同的htm</p></li><li><p>局部自适应：例如三栏布局，中间一栏随尺寸大小伸缩。</p></li></ol><p>主要通过js判断设备的类型或控制局部的变化</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">redirect</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获取设备信息</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> userAgent = navigator.<span class="property">userAgent</span>.<span class="title function_">toLowerCase</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//正则表达式来判断设备类型</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> device = <span class="regexp">/ipad|iphone|midp|windows ce/</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span>(device.<span class="title function_">test</span>(userAgent))&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//跳转到移动端页面</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;move.html&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//跳转到pc端页面</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;pc.html&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>三栏布局类型：</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//外部大容器</span><br><span class="line"> <span class="selector-class">.div0</span> &#123;</span><br><span class="line">   <span class="attribute">display</span>: flex;</span><br><span class="line"> &#125;</span><br><span class="line"> //两侧不变，中间伸缩</span><br><span class="line"> <span class="selector-class">.div0</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">   <span class="attribute">background-color</span>: antiquewhite;</span><br><span class="line">   <span class="attribute">flex</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">50px</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.div0</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">   <span class="attribute">background-color</span>: aqua;</span><br><span class="line">   <span class="attribute">flex</span>: <span class="number">1</span> <span class="number">1</span> auto;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.div0</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">   <span class="attribute">background-color</span>: antiquewhite;</span><br><span class="line">   <span class="attribute">flex</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">50px</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> //配合媒体查询</span><br><span class="line"> <span class="keyword">@media</span> (<span class="attribute">min-device-width</span>: <span class="number">400px</span>) <span class="keyword">and</span> (<span class="attribute">max-device-width</span>: <span class="number">500px</span>) &#123;</span><br><span class="line">   <span class="selector-class">.div0</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">     <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="响应式布局"><a href="#响应式布局" class="headerlink" title="响应式布局"></a>响应式布局</h3><p>确保一个页面在所有终端上，都能显示出令人满意的效果。</p><p>以%或rem为单位；</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;响应式布局&lt;/p&gt;
&lt;h3 id=&quot;媒体查询-mediaQuery&quot;&gt;&lt;a href=&quot;#媒体查询-mediaQuery&quot; class=&quot;headerlink&quot; title=&quot;媒体查询 mediaQuery&quot;&gt;&lt;/a&gt;媒体查询 mediaQuery&lt;/h3&gt;&lt;h4 id=&quot;</summary>
      
    
    
    
    
    <category term="css" scheme="https://kukupii.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>Vue源码阅读笔记</title>
    <link href="https://kukupii.github.io/2022/12/20/Vue%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/"/>
    <id>https://kukupii.github.io/2022/12/20/Vue%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/</id>
    <published>2022-12-20T08:12:23.000Z</published>
    <updated>2022-12-20T07:34:06.934Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV1rC4y187Vw/?spm_id_from=333.1007.top_right_bar_window_default_collection.content.click&vd_source=d247184ffe2b5293f1c76874d6153aed">跟尤雨溪一起解读Vue3源码【中英字幕】- Vue Mastery</a>观看笔记记录。</p><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><h3 id="what-is-the-DOM"><a href="#what-is-the-DOM" class="headerlink" title="what is the DOM?"></a>what is the DOM?</h3><p>Document Object Model. This is our browser’s interface(API) to change what is displayed on the screen. HTML maps to a series of DOM nodes that we can manipulate by JavaScript.</p><p>文件对象模型，浏览器页面所呈现的内容。把HTML加载到浏览器，浏览器创建一系列的DOM节点，并渲染在页面上，这些DOM节点可以使用JS进行操作。</p><h3 id="Virtual-DOM"><a href="#Virtual-DOM" class="headerlink" title="Virtual DOM"></a>Virtual DOM</h3><p>DOM tree上可以有成千上万的DOM节点，搜索和更新起来非常困难，因此诞生了Virtual DOM.</p><p>Virtual DOM is a way of representing the actual DOM with JavaScript Objects.</p><p>一个简单的HTML，比如<code>&lt;div&gt;hello&lt;/div&gt;</code>,可以通过Vnode表现为</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">tag</span>:<span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">    <span class="attr">children</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="attr">text</span>:<span class="string">&#x27;hello&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Vue基于模板创建一个渲染函数，并返回一个Vnode对象,例如</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params">h</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当Vnode有变化时，渲染函数再次运行，创建一个新的vnode节点，并与旧vnode节点对比（diff）。</p><h3 id="Vue-core-module"><a href="#Vue-core-module" class="headerlink" title="Vue core module:"></a>Vue core module:</h3><p>Reactivity module, Compiler Module, Renderer Module.</p><h4 id="Reactivity-module"><a href="#Reactivity-module" class="headerlink" title="Reactivity module:"></a>Reactivity module:</h4><p>allow us to create JavaScript reactive objects that can be watched for changes.</p><p>when code which uses these objects are run, they’re tracked, so they can be run later if the reactivity object changes.</p><h4 id="Compiler-Module"><a href="#Compiler-Module" class="headerlink" title="Compiler Module:"></a>Compiler Module:</h4><p>takes HTML templates and compiles them into render functions, more often happens when a Vue project is built, so that a browser only ever receives render functions.</p><h4 id="Renderer-Module"><a href="#Renderer-Module" class="headerlink" title="Renderer Module:"></a>Renderer Module:</h4><p><strong>Three phases: Render, mount and patch.</strong></p><p>render phase: call render function and return virtual DOM node.</p><p>mount phase: use vnode creates webpage</p><p>patch phase: compare old vnode with new vnode, and only updates the changed part.</p><h3 id="Walking-through-a-simple-Vue-app-a-template-which-reference-to-a-reactive-object"><a href="#Walking-through-a-simple-Vue-app-a-template-which-reference-to-a-reactive-object" class="headerlink" title="Walking through a simple Vue app: a template which reference to a reactive object"></a>Walking through a simple Vue app: a template which reference to a reactive object</h3><ol><li><p>the template compiler changes HTML into a render function</p></li><li><p>the reactive objects are initialized using the reactivity module</p></li><li><p>the render function returns a DOM node.  it’s referred reactive object, now be watched.</p></li><li><p>the mount phase uses the VNode to create the DOM to webpage</p></li><li><p>if any changes happen to our reactive object, it will cause a re-render</p></li></ol><h2 id="Rendering-Mechanism"><a href="#Rendering-Mechanism" class="headerlink" title="Rendering Mechanism"></a>Rendering Mechanism</h2><h3 id="Benefits-of-Virtual-DOM"><a href="#Benefits-of-Virtual-DOM" class="headerlink" title="Benefits of Virtual DOM:"></a>Benefits of Virtual DOM:</h3><ol><li><p>Decouples rendering logical from the actual DOM - makes it straighforward to reuse it in non-browser envirnoment, e.g. rendering to a string(SSR), rendering to a canvas&#x2F;WebGL, or native mobile rendering.</p></li><li><p>Provides the ability to programmatically construct, inspect, clone and create derivative structures before actually returning it to the rendering engine, and it using the full power of JavaScript.</p></li></ol><p>Conclusion: templates will get where you want to go, in 99% situation, you only need to write down the HTML, but if you want to do something programmatically, in that case, you need to code up a render funtion.</p><h3 id="What-is-render-function"><a href="#What-is-render-function" class="headerlink" title="What is render function?"></a>What is render function?</h3><p>In <strong>Vue2</strong> API (more nestle)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params">h</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">attrs</span>:&#123;</span><br><span class="line">            <span class="attr">id</span>:<span class="string">&#x27;foo&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">on</span>:&#123;</span><br><span class="line">            <span class="attr">click</span>:<span class="variable language_">this</span>.<span class="property">onClick</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In <strong>Vue3</strong> API</p><ul><li><p>Flat props structure</p></li><li><p>Globally imported <code>h</code> helper</p></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>,&#123;</span><br><span class="line">        <span class="attr">id</span>:<span class="string">&#x27;foo&#x27;</span>,</span><br><span class="line">        <span class="attr">onClick</span>: <span class="variable language_">this</span>.<span class="property">onClick</span></span><br><span class="line">    &#125;, <span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rC4y187Vw/?spm_id_from=333.1007.top_right_bar_window_default_collection.content.click&amp;vd_sourc</summary>
      
    
    
    
    
    <category term="vue3" scheme="https://kukupii.github.io/tags/vue3/"/>
    
    <category term="notes" scheme="https://kukupii.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>js30学习笔记（01~05）</title>
    <link href="https://kukupii.github.io/2022/11/17/js30%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%8801~05%EF%BC%89/"/>
    <id>https://kukupii.github.io/2022/11/17/js30%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%8801~05%EF%BC%89/</id>
    <published>2022-11-17T08:12:23.000Z</published>
    <updated>2022-11-17T08:55:38.202Z</updated>
    
    <content type="html"><![CDATA[<p>JavaScirpt30 是 Wes Bos 推出的一个 30 天挑战。项目免费提供了 30 个视频教程、30 个挑战的起始文档和 30 个挑战解决方案源代码。目的是帮助人们用纯 JavaScript 来写东西，不借助框架和库，也不使用编译器和引用。 </p><p>Github库：(<a href="https://github.com/soyaine/JavaScript30">GitHub - soyaine&#x2F;JavaScript30: 有关 @wesbos 的课程 JavaScript-30 的中文练习指南</a>)</p><h2 id="JavaScript-Drum-Kit"><a href="#JavaScript-Drum-Kit" class="headerlink" title="JavaScript Drum Kit"></a>JavaScript Drum Kit</h2><h3 id="Array-from"><a href="#Array-from" class="headerlink" title="Array.from()"></a>Array.from()</h3><p>Document.querySelector()选定的是NodeList，如果要用forEach循环，首先要用Array.from()转换。</p><h3 id="currentTime"><a href="#currentTime" class="headerlink" title="currentTime"></a>currentTime</h3><p>currentTime 属性设置或返回视频播放的当前位置（以秒计）。</p><p>当设置该属性时，播放会跳跃到指定的位置。</p><p><code>document.getElementById(&quot;myVideo&quot;).currentTime = 5;</code></p><h3 id="Tansitionend-addEventHandler的事件"><a href="#Tansitionend-addEventHandler的事件" class="headerlink" title="Tansitionend (addEventHandler的事件)"></a>Tansitionend (addEventHandler的事件)</h3><p>transitionend事件会在CSS transition结束后触发。当transition完成前移除transition 时，比如移除css的transition-property属性，事件将不会被触发。如在transition完成前设置display为”none”，事件同样不会被触发。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">    funciton <span class="title function_">remove</span>(<span class="params">event</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (event.<span class="property">propertyName</span> !== <span class="string">&#x27;border-left-color&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;playing&#x27;</span>);</span><br><span class="line">      <span class="comment">// event.target.classList.remove(&#x27;playing&#x27;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="纯-JS、CSS-时钟"><a href="#纯-JS、CSS-时钟" class="headerlink" title="纯 JS、CSS 时钟"></a>纯 JS、CSS 时钟</h2><h3 id="transition-timing-function-cubic-bezier-x-x-x-x"><a href="#transition-timing-function-cubic-bezier-x-x-x-x" class="headerlink" title="transition-timing-function: cubic-bezier(x, x, x, x)"></a>transition-timing-function: cubic-bezier(x, x, x, x)</h3><p>transition-timing-function属性指定切换效果的速度。</p><p>此属性允许一个过渡效果，以改变其持续时间的速度。</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>linear</td><td>规定以相同速度开始至结束的过渡效果（等于 cubic-bezier(0,0,1,1)）。</td></tr><tr><td>ease</td><td>规定慢速开始，然后变快，然后慢速结束的过渡效果（cubic-bezier(0.25,0.1,0.25,1)）。</td></tr><tr><td>ease-in</td><td>规定以慢速开始的过渡效果（等于 cubic-bezier(0.42,0,1,1)）。</td></tr><tr><td>ease-out</td><td>规定以慢速结束的过渡效果（等于 cubic-bezier(0,0,0.58,1)）。</td></tr><tr><td>ease-in-out</td><td>规定以慢速开始和结束的过渡效果（等于 cubic-bezier(0.42,0,0.58,1)）。</td></tr><tr><td>cubic-bezier(<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>)</td><td>在 cubic-bezier 函数中定义自己的值。可能的值是 0 至 1 之间的数值。</td></tr></tbody></table><h3 id="transform-origin"><a href="#transform-origin" class="headerlink" title="transform-origin"></a>transform-origin</h3><p>transform-Origin属性是用来更改转换元素的位置。</p><p>2D转换元素可以改变元素的X和Y轴。 3D转换元素，还可以更改元素的Z轴。</p><p>默认值为50% 50% 0，分别对应x轴、y轴和z轴。</p><h2 id="CSS-Variable"><a href="#CSS-Variable" class="headerlink" title="CSS Variable"></a>CSS Variable</h2><h3 id="root-伪类"><a href="#root-伪类" class="headerlink" title=":root 伪类"></a>:root 伪类</h3><p>这个伪元素匹配的是文档根元素，即<html>。常用于声明全局的css变量；</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123; </span><br><span class="line"> <span class="attr">--color</span>: <span class="number">#fff</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>在使用时：</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">img</span> &#123;  </span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--base);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="filter-blur"><a href="#filter-blur" class="headerlink" title="filter:blur();"></a>filter:blur();</h3><p>    filter:blur(20px)实现背景图片模糊效果。</p><h3 id="trick-使用dataset来储存单位后缀，如px；"><a href="#trick-使用dataset来储存单位后缀，如px；" class="headerlink" title="trick: 使用dataset来储存单位后缀，如px；"></a>trick: 使用dataset来储存单位后缀，如px；</h3><h3 id="用JavaScript改变CSS属性值："><a href="#用JavaScript改变CSS属性值：" class="headerlink" title="用JavaScript改变CSS属性值："></a>用JavaScript改变CSS属性值：</h3><p>如：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--color&#x27;</span>,<span class="string">&#x27;#35843&#x27;</span>);</span><br><span class="line"><span class="comment">// get variable from inline style  </span></span><br><span class="line">element.<span class="property">style</span>.<span class="title function_">getPropertyValue</span>(<span class="string">&quot;--my-var&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get variable from wherever  </span></span><br><span class="line"><span class="title function_">getComputedStyle</span>(element).<span class="title function_">getPropertyValue</span>(<span class="string">&quot;--my-var&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// set variable on inline style  </span></span><br><span class="line">element.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&quot;--my-var&quot;</span>, jsVar + <span class="number">4</span>);</span><br></pre></td></tr></table></figure><h3 id="善用this-keyword"><a href="#善用this-keyword" class="headerlink" title="善用this keyword"></a>善用this keyword</h3><p>使用addEventListener时，善用this。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(</span><br><span class="line">      <span class="string">`--<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>,</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.value&#125;</span><span class="subst">$&#123;end&#125;</span>`</span></span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line">inputs.<span class="title function_">forEach</span>(<span class="function">(<span class="params">input</span>) =&gt;</span> &#123;</span><br><span class="line">    input.<span class="title function_">addEventListener</span>(<span class="string">&quot;change&quot;</span>, handlerUpdate);</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure><p> </p><h2 id="Array-Cardio-💪"><a href="#Array-Cardio-💪" class="headerlink" title="Array Cardio 💪"></a>Array Cardio 💪</h2><h3 id="Array-prototype-sort"><a href="#Array-prototype-sort" class="headerlink" title="Array.prototype.sort();"></a>Array.prototype.sort();</h3><p>    语法：arr.sort([compareFunction])；</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> items = [</span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&quot;Edward&quot;</span>, <span class="attr">value</span>: <span class="number">21</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&quot;Sharpe&quot;</span>, <span class="attr">value</span>: <span class="number">37</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&quot;And&quot;</span>, <span class="attr">value</span>: <span class="number">45</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&quot;The&quot;</span>, <span class="attr">value</span>: -<span class="number">12</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&quot;Magnetic&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&quot;Zeros&quot;</span>, <span class="attr">value</span>: <span class="number">37</span> &#125;,</span><br><span class="line">     ];</span><br><span class="line">      <span class="comment">// sort by value</span></span><br><span class="line">      items.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> a.<span class="property">value</span> - b.<span class="property">value</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// sort by name</span></span><br><span class="line">      items.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> nameA = a.<span class="property">name</span>.<span class="title function_">toUpperCase</span>(); <span class="comment">// ignore upper and lowercas</span></span><br><span class="line">         <span class="keyword">var</span> nameB = b.<span class="property">name</span>.<span class="title function_">toUpperCase</span>(); <span class="comment">// ignore upper andlowercase</span></span><br><span class="line">        <span class="keyword">if</span> (nameA &lt; nameB) &#123;</span><br><span class="line">          <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nameA &gt; nameB) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// names must be equal</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">         &#125;);</span><br></pre></td></tr></table></figure><h3 id="Array-prototype-reduce"><a href="#Array-prototype-reduce" class="headerlink" title="Array.prototype.reduce"></a>Array.prototype.reduce</h3><p>    语法 : reduce((previousValue, currentValue, currentIndex) &#x3D;&gt; { &#x2F;* … *&#x2F; } , initialValue);</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Counting instances of values in an object</span></span><br><span class="line"><span class="keyword">const</span> names = [<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Tiff&quot;</span>, <span class="string">&quot;Bruce&quot;</span>, <span class="string">&quot;Alice&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> countNames = names.<span class="title function_">reduce</span>(<span class="function">(<span class="params">allNames, name</span>) =&gt;</span> &#123;</span><br><span class="line">    allNames[name] ? allNames[name]++ : (allNames[name] = <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> allNames;</span><br><span class="line"> &#125;, &#123;&#125;);</span><br></pre></td></tr></table></figure><h3 id="在网站中筛选"><a href="#在网站中筛选" class="headerlink" title="在网站中筛选"></a>在网站中筛选</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// create a list of Boulevards in Paris that contain &#x27;de&#x27; anywhere in the name</span></span><br><span class="line"><span class="comment">// https://en.wikipedia.org/wiki/Category:Boulevards _in_Paris</span></span><br><span class="line">   <span class="keyword">const</span> cates = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">`.mw-category-group ul a`</span>)</span><br><span class="line">   <span class="keyword">const</span> listWithDe = <span class="title class_">Array</span>.<span class="title function_">from</span>(cates)</span><br><span class="line">        .<span class="title function_">map</span>(<span class="function">(<span class="params">cate</span>) =&gt;</span> cate.<span class="property">innerText</span>)</span><br><span class="line">       .<span class="title function_">filter</span>(<span class="function">(<span class="params">links</span>) =&gt;</span> links.<span class="title function_">includes</span>(<span class="string">&quot;de&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="Day5-Flex-Panel-Gallery"><a href="#Day5-Flex-Panel-Gallery" class="headerlink" title="Day5 Flex Panel Gallery"></a>Day5 Flex Panel Gallery</h2><h3 id="transition属性"><a href="#transition属性" class="headerlink" title="transition属性"></a>transition属性</h3><p>    transition: <em>property duration timing-function delay</em> ;</p><p>    transition-property 表示哪个属性开始变化，比如background, width</p><p>    transition-duration 表示该变化持续多久时间</p><p>    timing-function 表示该变化时间的速度曲线</p><p>    delay 表示该变化何时开始</p><p>    默认值：all 0 ease 0</p><h3 id="flex布局"><a href="#flex布局" class="headerlink" title="flex布局"></a>flex布局</h3><p>MDN: <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">flex 布局的基本概念 - CSS（层叠样式表） | MDN</a></p><h3 id="transform属性"><a href="#transform属性" class="headerlink" title="transform属性"></a>transform属性</h3><p>    transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。</p><p>    transform: translateY(-100%);</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;JavaScirpt30 是 Wes Bos 推出的一个 30 天挑战。项目免费提供了 30 个视频教程、30 个挑战的起始文档和 30 个挑战解决方案源代码。目的是帮助人们用纯 JavaScript 来写东西，不借助框架和库，也不使用编译器和引用。 &lt;/p&gt;
&lt;p&gt;Git</summary>
      
    
    
    
    
    <category term="js30" scheme="https://kukupii.github.io/tags/js30/"/>
    
    <category term="javascript" scheme="https://kukupii.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>抽离组件——Uploader组件</title>
    <link href="https://kukupii.github.io/2022/11/03/%E6%8A%BD%E7%A6%BB%E7%BB%84%E4%BB%B6%E2%80%94%E2%80%94Uploader%E7%BB%84%E4%BB%B6/"/>
    <id>https://kukupii.github.io/2022/11/03/%E6%8A%BD%E7%A6%BB%E7%BB%84%E4%BB%B6%E2%80%94%E2%80%94Uploader%E7%BB%84%E4%BB%B6/</id>
    <published>2022-11-03T13:04:17.000Z</published>
    <updated>2022-11-17T08:43:06.107Z</updated>
    
    <content type="html"><![CDATA[<h2 id="上传文件的两种实现方式"><a href="#上传文件的两种实现方式" class="headerlink" title="上传文件的两种实现方式"></a>上传文件的两种实现方式</h2><ol><li><p>form-submission</p></li><li><p>JavaScript发送异步请求</p></li></ol><h3 id="Form-submission"><a href="#Form-submission" class="headerlink" title="Form-submission"></a>Form-submission</h3><p>使用<code>&lt;form&gt;</code>标签。</p><p>跟普通的字符串不同，文件是二进制格式，所以要额外设置<code>enctype=&#39;multipart/form-data&#39;</code>。</p><p>关于 POST encType 的描述:<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST">POST - HTTP | MDN</a></p><ul><li>application&#x2F;x-www-form-urlencoded: 数据被编码成以 ‘&amp;’ 分隔的键-值对, 同时以 ‘&#x3D;’ 分隔键和值. 非字母或数字的字符会被 percent-encoding: 这也就是为什么这种类型不支持二进制数据(应使用 multipart&#x2F;form-data 代替).</li><li>multipart&#x2F;form-data</li><li>text&#x2F;plain</li></ul><p>具体例子：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">//form中的action属性指向submit后发送到的后端url</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;post&#x27;</span> <span class="attr">enctype</span>=<span class="string">&#x27;multipart/form-data&#x27;</span> <span class="attr">acion</span>=<span class="string">&#x27;/api/upload&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">file</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JavaScript发送异步请求"><a href="#JavaScript发送异步请求" class="headerlink" title="JavaScript发送异步请求"></a>JavaScript发送异步请求</h3><p>监听<code>input</code>的<code>change</code>事件</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleFileChange</span> = (<span class="params">e:Event</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = e.<span class="property">target</span> <span class="keyword">as</span> <span class="title class_">HTMLInputElement</span>;</span><br><span class="line">    <span class="keyword">const</span> files = target.<span class="property">files</span>; </span><br><span class="line">    <span class="comment">//因为可以上传多个文件，files为array-like object，可以使用Array.from()转换为数组</span></span><br><span class="line">    <span class="comment">//只选取第一个文件可以用files[0]</span></span><br><span class="line">    <span class="keyword">if</span>(files)&#123;</span><br><span class="line">    <span class="keyword">const</span> uploadedFile = files[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">//模拟表单数据，使用FormData对象，可以很方便地以JavaScript创建HTML&lt;form&gt;这个data</span></span><br><span class="line">    <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">    <span class="comment">//使用append方法添加新的属性值。</span></span><br><span class="line">    <span class="comment">//formData.append(name,value)</span></span><br><span class="line">    formData.<span class="title function_">append</span>(uploadedFile.<span class="property">name</span>, uploadedFile);</span><br><span class="line">    <span class="comment">//发送该表单数据请求（POST）</span></span><br><span class="line">    axios.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, formData, &#123;</span><br><span class="line">    <span class="comment">//第三个参数为config，设置header转换格式。</span></span><br><span class="line">    <span class="attr">headers</span>:&#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;multipart/form-data&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).<span class="title function_">then</span>(...)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Uploader组件需求设计"><a href="#Uploader组件需求设计" class="headerlink" title="Uploader组件需求设计"></a>Uploader组件需求设计</h2><ol><li><p>接受验证功能 &#x3D;&gt; 验证文件的格式&#x2F;大小</p></li><li><p>接受action &#x3D;&gt; 自定义后端url</p></li><li><p>发送事件 &#x3D;&gt; 上传成功事件和上传失败事件</p></li><li><p>有状态 &#x3D;&gt; 上传前、中、后</p></li><li><p>上传成功后，显示上传图片</p></li></ol><h3 id="接受验证功能"><a href="#接受验证功能" class="headerlink" title="接受验证功能"></a>接受验证功能</h3><p>CheckFuntion应该在上传文件前进行调用，因此设置一个props为beforeUploaded接受一个验证函数，参数为文件，结果为布尔值，验证通过提交文件，否则return。</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CheckFuntion</span> = <span class="function">(<span class="params">file:File</span>) =&gt;</span> <span class="built_in">boolean</span>;</span><br><span class="line"><span class="attr">props</span>:&#123;</span><br><span class="line">    <span class="attr">beforeUploaded</span>:&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Funtion</span> <span class="keyword">as</span> <span class="title class_">PropType</span>&lt;<span class="title class_">CheckFuntion</span>&gt;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 在setup中handleFileChange函数中进行验证</span></span><br><span class="line"><span class="keyword">if</span> (props.<span class="property">beforeUploaded</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = props.<span class="title function_">beforeUploaded</span>(selectedFile);</span><br><span class="line">    <span class="keyword">if</span>(!result)&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure><h3 id="自定义后端url"><a href="#自定义后端url" class="headerlink" title="自定义后端url"></a>自定义后端url</h3><p>props接受action，类型为<code>String</code>，在axios.post时调用。</p><h3 id="发送成功和失败事件和改变状态"><a href="#发送成功和失败事件和改变状态" class="headerlink" title="发送成功和失败事件和改变状态"></a>发送成功和失败事件和改变状态</h3><p>在Promise的then和catch中分别emit相关事件，传入成功值和错误，并改变状态值。</p><h3 id="上传成功后显示上传图片"><a href="#上传成功后显示上传图片" class="headerlink" title="上传成功后显示上传图片"></a>上传成功后显示上传图片</h3><p>具体文档：<a href="https://cn.vuejs.org/guide/components/slots.html#scoped-slots">插槽 Slots | Vue.js</a></p><p>插槽的内容同时使用父组件域内和子组件域内的数据，要做到这一点，我们需要一种方法来让子组件在渲染时将一部分数据提供给插槽。</p><p>因此，要向上传成功插槽的出口上传递 attributes：</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;slot</span><br><span class="line">        v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">&quot;uploadStatus === &#x27;success&#x27;&quot;</span></span><br><span class="line">        name=<span class="string">&quot;uploaded&quot;</span>  </span><br><span class="line">        <span class="comment">//uploadData在axios.post请求成功返回后赋值</span></span><br><span class="line">        :uploadData=<span class="string">&quot;uploadData&quot;</span></span><br><span class="line">      &gt;</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>上传成功<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;/slot&gt;</span><br></pre></td></tr></table></figure><p>在使用此插槽的组件，即CreatePost中通过子组件标签上的 <code>v-slot</code> 指令，直接接收到了一个插槽 props 对象：</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;template #uploaded=<span class="string">&quot;dataProps&quot;</span>&gt;</span><br><span class="line">        <span class="comment">//可以直接使用，然后使用img标签显示</span></span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;dataProps.uploadData.data.url&quot;</span> /&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>子组件传入插槽的 props 作为了 <code>v-slot</code> 指令的值，可以在插槽内的表达式中访问。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;上传文件的两种实现方式&quot;&gt;&lt;a href=&quot;#上传文件的两种实现方式&quot; class=&quot;headerlink&quot; title=&quot;上传文件的两种实现方式&quot;&gt;&lt;/a&gt;上传文件的两种实现方式&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;form-submission&lt;/p&gt;
&lt;/li&gt;</summary>
      
    
    
    
    
    <category term="typescript" scheme="https://kukupii.github.io/tags/typescript/"/>
    
    <category term="vue" scheme="https://kukupii.github.io/tags/vue/"/>
    
    <category term="zheye" scheme="https://kukupii.github.io/tags/zheye/"/>
    
    <category term="component" scheme="https://kukupii.github.io/tags/component/"/>
    
    <category term="conclusion" scheme="https://kukupii.github.io/tags/conclusion/"/>
    
  </entry>
  
  <entry>
    <title>通用错误处理——axios拦截</title>
    <link href="https://kukupii.github.io/2022/10/30/%E9%80%9A%E7%94%A8%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E2%80%94%E2%80%94axios%E6%8B%A6%E6%88%AA/"/>
    <id>https://kukupii.github.io/2022/10/30/%E9%80%9A%E7%94%A8%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E2%80%94%E2%80%94axios%E6%8B%A6%E6%88%AA/</id>
    <published>2022-10-30T03:44:23.000Z</published>
    <updated>2022-11-17T08:44:02.472Z</updated>
    
    <content type="html"><![CDATA[<p>重点：</p><ol><li><p>组件改用函数调用形式。</p></li><li><p>使用Vnode组成VitrualDom，并使用render function渲染。</p></li></ol><h2 id="通用错误处理"><a href="#通用错误处理" class="headerlink" title="通用错误处理"></a>通用错误处理</h2><p>Axios 拦截器的文档地址:<a href="https://axios-http.com/docs/interceptors">Interceptors | Axios Docs</a></p><p>示例代码:</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Add a request interceptor</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="comment">// Do something before request is sent</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// Do something with request error</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add a response interceptor</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="comment">// Any status code that lie within the range of 2xx cause this function to trigger</span></span><br><span class="line">    <span class="comment">// Do something with response data</span></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// Any status codes that falls outside the range of 2xx cause this function to trigger</span></span><br><span class="line">    <span class="comment">// Do something with response error</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>实际代码：</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.ts中</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">//把错误复原，以免错误窗口只出现一次</span></span><br><span class="line">  store.<span class="title function_">setError</span>(<span class="literal">false</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    store.<span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//解构错误信息</span></span><br><span class="line">    <span class="keyword">const</span> &#123; error &#125; = e.<span class="property">response</span>.<span class="property">data</span>;</span><br><span class="line">    <span class="comment">//设置error</span></span><br><span class="line">    store.<span class="title function_">setError</span>(<span class="literal">true</span>, error);</span><br><span class="line">    store.<span class="title function_">setLoading</span>(ftyalse);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//store.ts中</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ErrorProps</span> &#123;</span><br><span class="line">  <span class="attr">status</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  message?: <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMainStore = <span class="title function_">defineStore</span>(<span class="string">&quot;main&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">error</span>: &#123; <span class="attr">status</span>: <span class="literal">false</span> &#125; <span class="keyword">as</span> <span class="title class_">ErrorProps</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>:&#123;</span><br><span class="line">    <span class="title function_">setError</span>(<span class="params">status: <span class="built_in">boolean</span>, msg: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">error</span> = &#123; <span class="attr">status</span>: status, <span class="attr">message</span>: msg &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="创建多种情况适用的Message组件"><a href="#创建多种情况适用的Message组件" class="headerlink" title="创建多种情况适用的Message组件"></a>创建多种情况适用的Message组件</h2><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Teleport</span> <span class="attr">to</span>=<span class="string">&quot;#message&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">class</span>=<span class="string">&quot;alert message-info fixed-top w-50 mx-auto d-flex justify-content-between mt-2&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">v-if</span>=<span class="string">&quot;isVisible&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">:class</span>=<span class="string">&quot;classObject&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;button&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">class</span>=<span class="string">&quot;close&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">aria-label</span>=<span class="string">&quot;Close&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">click.prevent</span>=<span class="string">&quot;close&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span>×<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Teleport</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; defineComponent, <span class="title class_">PropType</span>, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> useDOMCreate <span class="keyword">from</span> <span class="string">&quot;../hooks/useDOMCreate&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> type <span class="title class_">MessageType</span> = <span class="string">&quot;error&quot;</span> | <span class="string">&quot;success&quot;</span> | <span class="string">&quot;default&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">message</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">type</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">type</span>: <span class="title class_">String</span> <span class="keyword">as</span> <span class="title class_">PropType</span>&lt;<span class="title class_">MessageType</span>&gt;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">default</span>: <span class="string">&quot;default&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">emits</span>: [<span class="string">&quot;close-message&quot;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">setup</span>(<span class="params">props, context</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">useDOMCreate</span>(<span class="string">&quot;message&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> isVisible = <span class="title function_">ref</span>(<span class="literal">true</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> classObject = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="string">&quot;alert-success&quot;</span>: props.<span class="property">type</span> === <span class="string">&quot;success&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="string">&quot;alert-danger&quot;</span>: props.<span class="property">type</span> === <span class="string">&quot;error&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="string">&quot;alert-primary&quot;</span>: props.<span class="property">type</span> === <span class="string">&quot;default&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> <span class="title function_">close</span> = (<span class="params"></span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      isVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      context.<span class="title function_">emit</span>(<span class="string">&quot;close-message&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123; isVisible, classObject, close &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="了解Vnode"><a href="#了解Vnode" class="headerlink" title="了解Vnode"></a>了解Vnode</h2><p>文档地址：<a href="https://vuejs.org/guide/extras/rendering-mechanism.html#virtual-dom">virtual-dom</a></p><p><strong>Virtual DOM：一种虚拟的，保存在内存中的数据结构，用来代表 UI 的表现</strong>，和真实 DOM 节点保持同步。Virtual DOM是由一系列的 Vnode 组成的。</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 模拟一个简单的 Vnode</span></span><br><span class="line"><span class="keyword">const</span> vnode = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">children</span>: [</span><br><span class="line">    <span class="comment">/* more vnodes */</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here, <code>vnode</code> is a plain JavaScript object (a “virtual node”) representing a <code>&lt;div&gt;</code> element. It contains all the information that we need to create the actual element. It also contains more children vnodes, which makes it the root of a virtual DOM tree.</p><p>A runtime renderer can walk a virtual DOM tree and construct a real DOM tree from it. This process is called <strong>mount</strong>.</p><p>If we have two copies of virtual DOM trees, the renderer can also walk and compare the two trees, figuring out the differences, and apply those changes to the actual DOM. This process is called <strong>patch</strong>, also known as “diffing” or “reconciliation”.</p><p>patch 的过程主要就是使用 diff 算法计算差别，然后更新的过程。</p><h4 id="Render-Pipeline"><a href="#Render-Pipeline" class="headerlink" title="Render Pipeline"></a>Render Pipeline</h4><ul><li><strong>Compile</strong>， Vue 组件的 Template 会被编译成 <strong>render function</strong>，一个可以返回 Virtual DOM 树的函数。</li><li><strong>Mount</strong>，执行 render function，遍历虚拟DOM 树，生成真正的 DOM 节点。</li><li><strong>Patch</strong>，当组件中任何响应式对象（依赖）发生变化的时候，执行更新操作 。生成新的虚拟节点树，Vue 内部会遍历新的虚拟节点树，和旧的树做对比，然后执行<strong>必要</strong>的更新。</li></ul><p><img src="https://vuejs.org/assets/render-pipeline.03805016.png" class="lazy" data-srcset="https://vuejs.org/assets/render-pipeline.03805016.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p><h4 id="Render-function"><a href="#Render-function" class="headerlink" title="Render function"></a>Render function</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在 main.ts 中</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">App</span>)</span><br><span class="line"><span class="comment">// 返回</span></span><br><span class="line"><span class="title class_">Object</span></span><br><span class="line">  <span class="attr">components</span>: &#123;<span class="title class_">HelloWorld</span>: &#123;…&#125;&#125;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;App&quot;</span></span><br><span class="line">  <span class="attr">render</span>: ƒ <span class="title function_">render</span>(_ctx, _cache, $props, $setup, $data, $options)</span><br><span class="line">  <span class="attr">setup</span>: ƒ ()  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 原始的 template</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">msg</span>=<span class="string">&quot;axyz&quot;</span>/&gt;</span></span></span><br><span class="line">  &#123;&#123; hello &#125;&#125;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// template 会被转换成这样的 function</span></span><br><span class="line">  <span class="keyword">const</span> _component_HelloWorld = <span class="title function_">_resolveComponent</span>(<span class="string">&quot;HelloWorld&quot;</span>)!</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (<span class="title function_">_openBlock</span>(), <span class="title function_">_createElementBlock</span>(_Fragment, <span class="literal">null</span>, [</span><br><span class="line">    <span class="title function_">_createVNode</span>(_component_HelloWorld, &#123; <span class="attr">msg</span>: <span class="string">&quot;axyz&quot;</span> &#125;),</span><br><span class="line">    <span class="title function_">_createTextVNode</span>(<span class="string">&quot; &quot;</span> + <span class="title function_">_toDisplayString</span>(_ctx.<span class="property">hello</span>), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ], <span class="number">64</span> <span class="comment">/* STABLE_FRAGMENT */</span>))</span><br></pre></td></tr></table></figure><h2 id="创建Vnode以及使用Render-function"><a href="#创建Vnode以及使用Render-function" class="headerlink" title="创建Vnode以及使用Render function"></a>创建Vnode以及使用Render function</h2><h4 id="创建Vnode"><a href="#创建Vnode" class="headerlink" title="创建Vnode"></a>创建Vnode</h4><p>h和createVnode都可以创建Vnode。两个用法差不多，后者名称更形象。</p><p>h 是 hyperscript 的缩写，意思就是 “JavaScript that produces HTML (hypertext markup language)”，很多 virtualDOM 的实现都使用这个函数名称。</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h, createVnode &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vnode = <span class="title function_">h</span>(</span><br><span class="line">  <span class="string">&#x27;div&#x27;</span>, <span class="comment">// type</span></span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;foo&#x27;</span>, <span class="attr">class</span>: <span class="string">&#x27;bar&#x27;</span> &#125;, <span class="comment">// props</span></span><br><span class="line">  [</span><br><span class="line">    <span class="comment">/* children */</span></span><br><span class="line">  ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="声明-Render-Function"><a href="#声明-Render-Function" class="headerlink" title="声明 Render Function"></a>声明 Render Function</h4><p>当使用 composition API 的时候，在 setup 当中直接返回一个对象，代表着给模版使用的数据，当要使用 render function 的时候，可以直接返回一个函数。</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> message = <span class="title function_">ref</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// 使用 template</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    message</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 使用 render function</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用-JSX"><a href="#使用-JSX" class="headerlink" title="使用 JSX"></a><strong>使用 JSX</strong></h4><p>是 h 函数的一种语法糖。可以将这种类似 HTML 的语法转换成 h 函数的写法。</p><p>添加JSX支持：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vue add babel</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建 vnode</span></span><br><span class="line"><span class="keyword">const</span> vnode = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="comment">// 使用变量</span></span><br><span class="line"><span class="keyword">const</span> vnode = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#123;dynamicId&#125;</span>&gt;</span>hello, &#123;userName&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ts文件要将后缀名改为<strong>tsx</strong>才能使用这种语法。</p><p>js&#x3D;&gt;jsx</p><h2 id="将组件改为函数调用形式并使用h函数"><a href="#将组件改为函数调用形式并使用h函数" class="headerlink" title="将组件改为函数调用形式并使用h函数"></a>将组件改为函数调用形式并使用h函数</h2><p>创建useCreateMessage.tsx文件</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h, render &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Message</span> <span class="keyword">from</span> <span class="string">&quot;../components/Message.vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageType</span> = <span class="string">&quot;error&quot;</span> | <span class="string">&quot;success&quot;</span> | <span class="string">&quot;default&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useCreateMessage</span> = (<span class="params"></span></span><br><span class="line"><span class="params">  message: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="keyword">type</span>: MessageType,</span></span><br><span class="line"><span class="params">  timeout?: <span class="built_in">number</span></span></span><br><span class="line"><span class="params"></span>) =&gt; &#123;  </span><br><span class="line">  <span class="comment">// Message：要渲染的组件，&#123;message,type&#125;：需要的props</span></span><br><span class="line">  <span class="keyword">const</span> messageVnode = <span class="title function_">h</span>(<span class="title class_">Message</span>, &#123;</span><br><span class="line">    message,</span><br><span class="line">    <span class="keyword">type</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//mountNode要挂载的DOM节点</span></span><br><span class="line">  <span class="keyword">const</span> mountNode = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(mountNode);</span><br><span class="line">  <span class="comment">//render function将vnode渲染到特定节点。</span></span><br><span class="line">  <span class="comment">//需要两个参数，第一个为vnode，第二个为需要的dom节点</span></span><br><span class="line">  <span class="title function_">render</span>(messageVnode, mountNode);</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">destory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//在特定的DOM节点上卸载，第一个参数为null</span></span><br><span class="line">    <span class="title function_">render</span>(<span class="literal">null</span>, mountNode);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(mountNode);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (timeout) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">destory</span>();</span><br><span class="line">    &#125;, timeout);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//实例上包括destory这个方法，无timeout时可以用程序的方式清空掉</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    destory,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useCreateMessage;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;重点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;组件改用函数调用形式。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用Vnode组成VitrualDom，并使用render function渲染。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;通用错误处理&quot;&gt;&lt;a href=&quot;#通用错误</summary>
      
    
    
    
    
    <category term="typescript" scheme="https://kukupii.github.io/tags/typescript/"/>
    
    <category term="vue" scheme="https://kukupii.github.io/tags/vue/"/>
    
    <category term="zheye" scheme="https://kukupii.github.io/tags/zheye/"/>
    
    <category term="error" scheme="https://kukupii.github.io/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>如何解决用户登陆和权限认证相关问题</title>
    <link href="https://kukupii.github.io/2022/10/27/%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E5%92%8C%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/"/>
    <id>https://kukupii.github.io/2022/10/27/%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E5%92%8C%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/</id>
    <published>2022-10-27T12:23:21.000Z</published>
    <updated>2022-11-17T08:42:38.668Z</updated>
    
    <content type="html"><![CDATA[<h2 id="总问题："><a href="#总问题：" class="headerlink" title="总问题："></a>总问题：</h2><ol><li><p>pinia 怎样发送post请求</p></li><li><p>token是什么</p></li><li><p>jwt的工作原理</p></li><li><p>jwt和session的区别</p></li><li><p>SPA应用中怎样持久化获取用户的状态</p></li><li><p>针对不同的请求的权限管理</p></li><li><p>怎样显示全局数据显示</p></li></ol><h2 id="Pinia怎样发送POST请求"><a href="#Pinia怎样发送POST请求" class="headerlink" title="Pinia怎样发送POST请求"></a>Pinia怎样发送POST请求</h2><p>建立一个单独的useAuthStore，在action中进行POST请求，使用async和await。</p><blockquote><p><strong>Unlike getters, <code>actions</code> can be asynchronous</strong>, you can <code>await</code> inside of actions any API call or even other actions!</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">userLogin</span>(<span class="params">payload: LoginProps</span>) &#123;</span><br><span class="line">    <span class="comment">// POST请求</span></span><br><span class="line">    <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&quot;/user/login&quot;</span>, payload);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><h2 id="Token是什么"><a href="#Token是什么" class="headerlink" title="Token是什么"></a>Token是什么</h2><p><strong>Token是服务端生成的一串字符串，以作客户端进行请求的一个令牌，当第一次登录后，服务器生成一个Token便将此Token返回给客户端</strong>，以后客户端只需带上这个Token前来请求数据即可，无需再次带上用户名和密码。token其实说的更通俗点可以叫暗号，在一些数据传输之前，要先进行暗号的核对，不同的暗号被授权不同的数据操作。</p><blockquote><p>Token在计算机身份认证中是<a href="https://baike.baidu.com/item/%E4%BB%A4%E7%89%8C/9716092?fromModule=lemma_inlink">令牌</a>（临时）的意思，在词法分析中是标记的意思。一般作为邀请、登录系统使用。</p></blockquote><h2 id="jwt的工作原理"><a href="#jwt的工作原理" class="headerlink" title="jwt的工作原理"></a>jwt的工作原理</h2><p>在jwt工作原理之前，先了解一下两个权限认证的途径。第一个是基于cookie和session的登录验证，另一个是基于token和jwt的。</p><h4 id="web应用中两个权限认证的途径："><a href="#web应用中两个权限认证的途径：" class="headerlink" title="web应用中两个权限认证的途径："></a>web应用中两个权限认证的途径：</h4><p>一、<strong>基于cookie和session的登陆验证（classic）（有状态）</strong></p><p>cookie：存储在客户端、不可跨域。</p><p>session：</p><ul><li>session 是另一种记录服务器和客户端会话状态的机制</li><li>session 是基于 cookie 实现的，session 存储在服务器端，sessionId 会被存储到客户端的cookie 中</li></ul><p>具体流程：</p><p>    <img title="" src="file:///C:/Users/15810/Desktop/QQ图片20221027205357.png" class="lazy" data-srcset="file:///C:/Users/15810/Desktop/QQ图片20221027205357.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" alt="" width="578"></p><ol><li><p>客户端发送登陆请求</p></li><li><p>服务器创建session，并存储在数据库中</p></li><li><p>服务器为用户生成一个sessionId，将具有sesssionId的Cookie将放置在用户浏览器中</p></li><li><p>在后续请求中，会根据数据库验证sessionID，如果有效，则接受请求</p></li><li><p>一旦用户注销应用程序，会话将在客户端和服务器端都被销毁</p></li></ol><p>**二、 <strong>基于token和jwt的权限认证（popular)（无状态）</strong></p><p>    具体流程：</p><p>    <img src="file:///C:/Users/15810/Desktop/@F@%4R$NHSSDMSC22]$9O9.png" class="lazy" data-srcset="file:///C:/Users/15810/Desktop/@F@%4R$NHSSDMSC22]$9O9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" title="" alt="" width="591"></p><p>1.客户端发送登陆请求</p><p>2.服务器接收后使用jwt算法生成对应的token，并返回客户端。</p><p>3.客户端存储token，并在之后的每次权限请求把token放在header中。</p><p>4.服务器反向验证返回的token，验证成功则返回请求的数据。</p><h4 id="jwt详解"><a href="#jwt详解" class="headerlink" title="jwt详解"></a>jwt详解</h4><p>    1.概念：</p><blockquote><p>JWT （JSON Web Token） 是目前最流行的跨域认证解决方案，是一种基于 Token 的认证授权机制。 从 JWT 的全称可以看出，JWT 本身也是 Token，一种规范化之后的 JSON 结构的 Token。</p></blockquote><p>    2.组成部分</p><p>      JWT 本质上就是一组字串，通过（<code>.</code>）切分成三个为 Base64 编码的部分：</p><ul><li><strong>Header</strong> : 描述 JWT 的元数据，定义了生成签名的算法以及 <code>Token</code> 的类型。</li><li><strong>Payload</strong> : 用来存放实际需要传递的数据</li><li><strong>Signature（签名）</strong> ：服务器通过 Payload、Header 和一个密钥(Secret)使用 Header 里面指定的签名算法（默认是 HMAC SHA256）生成。</li></ul><p>    JWT 通常是这样的：<code>xxxxx.yyyyy.zzzzz</code>。</p><p>    3.解码网站：<a href="https://jwt.io/">https://jwt.io/</a></p><p>    <img src="https://cdn.jsdelivr.net/gh/kukupii/ImgBed-Rep/img/QQ图片20221027212147.png" class="lazy" data-srcset="https://cdn.jsdelivr.net/gh/kukupii/ImgBed-Rep/img/QQ图片20221027212147.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" title="" alt="" width="600"></p><h2 id="jwt和session的区别"><a href="#jwt和session的区别" class="headerlink" title="jwt和session的区别"></a>jwt和session的区别</h2><p>    1.本身含义：</p><p>    <code>jwt</code>本身包含用户信息；<code>Session</code>传递的sessionId虽然是一个更简单的字符串，但它本身并没有任何含义。</p><p>    2.用户的状态保存的位置：</p><p>    session是保存在服务端的，而jwt是保存在客户端的。</p><h2 id="SPA应用中如何持久化获取用户的状态"><a href="#SPA应用中如何持久化获取用户的状态" class="headerlink" title="SPA应用中如何持久化获取用户的状态"></a>SPA应用中如何持久化获取用户的状态</h2><p><strong>客户端存储的三种方案</strong></p><ul><li><p>cookie：不支持跨域</p></li><li><p>sessionStorage：页面关闭会被清除</p></li><li><p>localStorage：可以长期保存</p></li></ul><p><strong>localStorage实现持久化的流程</strong></p><p><img src="https://cdn.jsdelivr.net/gh/kukupii/ImgBed-Rep/img/QQ%E5%9B%BE%E7%89%8720221027214350.png" class="lazy" data-srcset="https://cdn.jsdelivr.net/gh/kukupii/ImgBed-Rep/img/QQ%E5%9B%BE%E7%89%8720221027214350.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p><p>因此实现登陆+持久化的整个流程如下</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// store.ts / action</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">userLogin</span>(<span class="params">payload: LoginProps</span>) &#123;</span><br><span class="line">      <span class="comment">//提交信息登陆</span></span><br><span class="line">      <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&quot;/user/login&quot;</span>, payload);</span><br><span class="line">      <span class="comment">//信息正确</span></span><br><span class="line">      <span class="keyword">if</span> (data.<span class="property">code</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//获取token</span></span><br><span class="line">        <span class="keyword">const</span> &#123; token &#125; = data.<span class="property">data</span>;</span><br><span class="line">        <span class="comment">//储存token</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">token</span> = token;</span><br><span class="line">        <span class="comment">//本地存储</span></span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>, token);</span><br><span class="line">        <span class="comment">//利用token获取用户信息</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">fetchCurrentUser</span>();</span><br><span class="line">        <span class="comment">//返回一个promise，以便catch错误</span></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">fetchCurrentUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> token = <span class="variable language_">this</span>.<span class="property">token</span>;</span><br><span class="line">      <span class="keyword">if</span> (token !== <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">//axios设置通用header，以便其他操作获取权限</span></span><br><span class="line">        axios.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">common</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span>;</span><br><span class="line">        <span class="comment">//获取用户信息</span></span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;/user/current&quot;</span>);</span><br><span class="line">        <span class="comment">//显示在界面</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">currentUser</span> = &#123; <span class="attr">isLogin</span>: <span class="literal">true</span>, ...data.<span class="property">data</span> &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">/</span><br></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//login.vue中</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleSubmit</span>(<span class="params">result: <span class="built_in">boolean</span></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result&quot;</span> + result);</span><br><span class="line">      <span class="keyword">if</span> (result) &#123;</span><br><span class="line">        <span class="keyword">const</span> payload = &#123;</span><br><span class="line">          <span class="attr">email</span>: emailVal.<span class="property">value</span>,</span><br><span class="line">          <span class="attr">password</span>: passwordVal.<span class="property">value</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">        store</span><br><span class="line">          .<span class="title function_">userLogin</span>(payload)</span><br><span class="line">          .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">useCreateMessage</span>(<span class="string">&quot;登陆成功 2秒后跳转首页&quot;</span>, <span class="string">&quot;success&quot;</span>, <span class="number">2000</span>);</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              router.<span class="title function_">push</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">            &#125;, <span class="number">2000</span>);</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;总问题：&quot;&gt;&lt;a href=&quot;#总问题：&quot; class=&quot;headerlink&quot; title=&quot;总问题：&quot;&gt;&lt;/a&gt;总问题：&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;pinia 怎样发送post请求&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;token是什么&lt;/p&gt;
&lt;/li&gt;
</summary>
      
    
    
    
    
    <category term="Auth" scheme="https://kukupii.github.io/tags/Auth/"/>
    
  </entry>
  
  <entry>
    <title>hexo使用方法备忘录</title>
    <link href="https://kukupii.github.io/2022/10/26/hexo%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    <id>https://kukupii.github.io/2022/10/26/hexo%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E5%A4%87%E5%BF%98%E5%BD%95/</id>
    <published>2022-10-26T11:49:09.000Z</published>
    <updated>2022-11-17T08:11:24.896Z</updated>
    
    <content type="html"><![CDATA[<p>为了防止重演悲剧（指因为忘记操作而痛失的上一个博客），还是写一篇小 tips 好噜。</p><h2 id="hexo-常用指令"><a href="#hexo-常用指令" class="headerlink" title="hexo 常用指令"></a>hexo 常用指令</h2><ol><li><p>新建文章 &#x3D;&gt; <code>hexo new 布局 &quot;文章名&quot;</code><br>布局可以是 <strong>post\draft\page</strong>;<br>如果是 post 可以省略，直接 hexo new “文章名”</p></li><li><p>部署与调试</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ hexo clean //清除本地生成的静态页面（public文件夹）</span><br><span class="line"></span><br><span class="line">$ hexo g //在本地生成静态页面（生成 public 文件夹）</span><br><span class="line"></span><br><span class="line">$ hexo s //启动本地服务 localhost，预览调试</span><br><span class="line"></span><br><span class="line">$ hexo d //远程部署，同步到 github</span><br></pre></td></tr></table></figure></li></ol><h2 id="MarkDown-文章相关"><a href="#MarkDown-文章相关" class="headerlink" title="MarkDown 文章相关"></a>MarkDown 文章相关</h2><ol><li>文章配置<br>tags:[tag1, tag2]</li><li>文章折叠<br>在文章中使用本插件：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% fold 折叠摘要 %&#125;</span><br><span class="line"></span><br><span class="line">    自定义正文</span><br><span class="line"></span><br><span class="line">&#123;% endfold %&#125;</span><br></pre></td></tr></table></figure><p>如果你希望某一折叠框默认展开：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% fold open, 折叠摘要 %&#125;</span><br><span class="line"></span><br><span class="line">    自定义正文</span><br><span class="line"></span><br><span class="line">&#123;% endfold %&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><p>文章标签插件</p><p>在文章中使用此插件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% note [ type ] 自定义小标题 %&#125;</span><br><span class="line">自定义正文</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>其中 <code>[ type ]</code> 可选填：<code>info</code>、<code>important</code>、<code>tip</code>、<code>caution</code>、<code>warning</code>，分别对应 5 种样式。</p></li></ol><h2 id="Markdown语法"><a href="#Markdown语法" class="headerlink" title="Markdown语法"></a>Markdown语法</h2><ol><li><p>标题用#，几个#表示几级标题。  </p><p>分割线（早期贴吧玩家狂喜）</p><p>    三个__: </p><hr><p><strong>加粗</strong>（**），_斜体_（__）,<del>删除线</del>（~~)  </p></li><li><p>链接</p></li></ol><p>        Autolinks: inside <code>&lt;</code> and <code>&gt;</code></p><p>        <a href="https://kukupii.github.io/">https://kukupii.github.io/</a></p><p>        Inline links:<code>[Assemble](http://assemble.io)</code></p><p>        <a href="https://kukupii.github.io/">LoploopBlog</a></p><ol start="3"><li>图片</li></ol><p>    <img title="" src="https://cdn.jsdelivr.net/gh/kukupii/ImgBed-Rep/img/avatar.jpg" class="lazy" data-srcset="https://cdn.jsdelivr.net/gh/kukupii/ImgBed-Rep/img/avatar.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" alt="" width="430"></p><p>（可以显示吗 我莉米米的 看不到的亏大了！</p><p>（方法：使用的github+PicGo+jsDelivr，方便的一匹！</p><ol start="4"><li><p>引用： use <code>&gt;</code> before any text you want to quote, can also be nested, means use multiple &gt;.</p><blockquote><p>Dancing like nobody is watching you.</p></blockquote></li><li><p>Todo List</p><ul><li><p><input disabled="" type="checkbox"> Hello.</p></li><li><p><input disabled="" type="checkbox"> I think this point is toooo bigggg!</p></li><li><p><input disabled="" type="checkbox"> and in a wrong position.</p></li><li><p><input disabled="" type="checkbox"> <a href="#special">special</a></p></li><li><p><input disabled="" type="checkbox"> upper one is special cuz it has a link.</p><p>normal:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- [ ] Lorem ipsum dolor sit amet</span><br><span class="line">- [ ] Consectetur adipiscing elit</span><br><span class="line">- [ ] Integer molestie lorem at massa</span><br></pre></td></tr></table></figure><p>Links in todo lists:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- [ ] [foo](#bar)</span><br><span class="line">- [ ] [baz](#qux)</span><br><span class="line">- [ ] [fez](#faz)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Table</p><p>I’m tired now… when I need use it I will know its usage.</p><p>So… bye~</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;为了防止重演悲剧（指因为忘记操作而痛失的上一个博客），还是写一篇小 tips 好噜。&lt;/p&gt;
&lt;h2 id=&quot;hexo-常用指令&quot;&gt;&lt;a href=&quot;#hexo-常用指令&quot; class=&quot;headerlink&quot; title=&quot;hexo 常用指令&quot;&gt;&lt;/a&gt;hexo 常用指令</summary>
      
    
    
    
    
    <category term="hexo" scheme="https://kukupii.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>TypeScript 知识点总结Part.1</title>
    <link href="https://kukupii.github.io/2022/10/25/TypeScript%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93Part.1/"/>
    <id>https://kukupii.github.io/2022/10/25/TypeScript%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93Part.1/</id>
    <published>2022-10-25T11:49:11.000Z</published>
    <updated>2022-10-26T11:28:08.921Z</updated>
    
    <content type="html"><![CDATA[<h2 id="原始数据类型和-Any-类型"><a href="#原始数据类型和-Any-类型" class="headerlink" title="原始数据类型和 Any 类型"></a>原始数据类型和 Any 类型</h2><p><strong>在新版的 ts 中，有一个特殊的配置是 strictNullChecks，在有些编辑器中默认为 true。它会严格检查 null 以及 undefined 类型，它只能赋值给本身的类型或者 any。文档在此：<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-0.html">https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-0.html</a></strong></p><p>可以在 tsconfig.json 将它设置为 false，就没有严格检查了。这个可以按照自己的喜好，开启或者关闭。</p><h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型 :"></a>数据类型 :</h3><ul><li>原始数据类型 boolean、number、string、null、undefined、 Symbol、BigInt。</li><li>Object.</li></ul><h3 id="Any-类型："><a href="#Any-类型：" class="headerlink" title="Any 类型："></a>Any 类型：</h3><p>可以赋任何类型的值，任意属性任意方法。</p><p>有明确类型时应避免使用 any。</p><h2 id="数组和元组"><a href="#数组和元组" class="headerlink" title="数组和元组"></a>数组和元组</h2><ol><li><p>数字数组：<br><code>let arrOfNum: number[] = [1,2,3];</code></p></li><li><p>array like object，比如 arguments;</p></li><li><p>任何数组：any[];</p></li><li><p>元组 tuple：在数组中加入不同类型的数据</p><p>起源于函数式编程</p><p>表述和数组非常类似；</p><p><code>let user:[string, number] = [&#39;kukupi&#39;,21];</code></p><p>多加一项或写错类型都会报错；</p><p>元组一定程度上限定了数据类型，本身是一个数组，所以可以使用数组方法。</p><p>可以使用 push 增加数据，但只能增加限定的数据类型中的。</p><p><em>eg</em>: _限定了 string 和 number，就不能 push boolean 值_。</p><p>两种类型的或者关系称之为<strong>联合类型</strong>。</p></li></ol><h2 id="interface-接口"><a href="#interface-接口" class="headerlink" title="interface 接口"></a><strong>interface 接口</strong></h2><ol><li>describes the shape of object</li><li>Duck Typing: 动态编程语言对象推断策略，关注对象如何被使用，而不是对象类型本身。</li></ol><p><strong>const 和 readonly 区别：const 用于 variable, readonly 用于 attribute；</strong></p><p>必须一一对应，不能多不能少，除了可选属性。</p><h2 id="Function-函数"><a href="#Function-函数" class="headerlink" title="Function 函数"></a>Function 函数</h2><p>1. 约定函数的输入和输出。</p><p>2. 可选参数（以?为标识）后不能有确定参数。</p><p>函数表达式：</p><p><code>const add = (x:number, y:number, z?:number):number =&gt; &#123;***&#125;</code></p><p>如果直接将其他函数定义为此函数类型，输出类型的符号要变成“&#x3D;&gt;”，即</p><p><code>const add2:(x:number,y:number,z?:number)=&gt;number = add</code></p><p>更为简洁的方法是将此函数类型放在接口里，多个其他函数使用此类型就方便很多，例</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">interface IAdd = &#123;</span><br><span class="line">(x:number, y:number, z?:number):number</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>使用时： <code>const add2:IAdd = add</code></p><h2 id="类型推论、联合类型和类型断言"><a href="#类型推论、联合类型和类型断言" class="headerlink" title="类型推论、联合类型和类型断言"></a><strong>类型推论、联合类型和类型断言</strong></h2><p>typescript 会在没指定类型时自动推断指定一个类型。</p><ol><li><strong><em>union types</em></strong></li></ol><p><code>let numberOrString: number | string;</code></p><p>只能访问此联合类型的共有属性和方法。</p><p><strong><em>2. 类型断言</em></strong></p><p>用<strong>as</strong>关键词；</p><p><strong><em>3. type guard 类型守卫</em></strong></p><p><strong>typeof</strong></p><h2 id="Enum-枚举"><a href="#Enum-枚举" class="headerlink" title="Enum 枚举"></a>Enum 枚举</h2><p>有点类似与一组常量数组</p><p><strong>数字枚举：</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enum Direction &#123;</span><br><span class="line">Up,</span><br><span class="line">Down,</span><br><span class="line">Left,</span><br><span class="line">Right,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(Direction.Up) // 0</span><br><span class="line">Direction[0] // Up</span><br></pre></td></tr></table></figure><p>成员会被赋值，默认从 0 开始依次递增的数字。可以改变默认起始值。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enum Direction &#123;</span><br><span class="line">Up = 10</span><br><span class="line">Down,</span><br><span class="line">Left,</span><br><span class="line">Right,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(Direction.Down) // 11</span><br><span class="line">Direction[10] // Up</span><br></pre></td></tr></table></figure><p>可以使用类似数组访问成员的方式反向访问枚举成员的属性 双向映射</p><p><strong>字符串枚举：</strong></p><p>每一项成员手动赋值</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enum Direction &#123;</span><br><span class="line">Up = &#x27;UP&#x27;</span><br><span class="line">Down = &#x27;DOWN&#x27;</span><br><span class="line">Left = &#x27;LEFT&#x27;</span><br><span class="line">Right = &#x27;RIGHT&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(Direction.up) // UP</span><br></pre></td></tr></table></figure><p>常量枚举声明：<br><code>const enum Direction&#123;&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;原始数据类型和-Any-类型&quot;&gt;&lt;a href=&quot;#原始数据类型和-Any-类型&quot; class=&quot;headerlink&quot; title=&quot;原始数据类型和 Any 类型&quot;&gt;&lt;/a&gt;原始数据类型和 Any 类型&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;在新版的 ts 中，有一个特</summary>
      
    
    
    
    
    <category term="typescript" scheme="https://kukupii.github.io/tags/typescript/"/>
    
  </entry>
  
</feed>
